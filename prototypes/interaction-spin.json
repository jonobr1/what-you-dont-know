{
	"config": {},
	"libraries": [
		"../release/third-party/WebAudio.js",
		"../prototypes/js/three.js",
		"../prototypes/js/VRController.js",
		"../prototypes/js/WebVR.js"
	],
	"includes": [
		[
			"setup",
			[
				"var renderer = new THREE.WebGLRenderer();",
				"var scene = new THREE.Scene();",
				"var camera = new THREE.PerspectiveCamera( 75 );",
				"",
				"var domElement = resources.get( 'dom' );",
				"var controller = new THREE.VRController();",
				"",
				"controller.position.set( 0.25, 0.75, 0 );",
				"controller.userData.raycaster = new THREE.Raycaster();",
				"",
				"var cursor = new THREE.Mesh(",
				"\tnew THREE.CylinderBufferGeometry( 0, 0.25, 10, 3, 1 ),",
				"\tnew THREE.MeshBasicMaterial({",
				"\t\tcolor: 'red',",
				"\t\ttransparent: true,",
				"\t\topacity: 0.5,",
				"\t\tblending: THREE.AdditiveBlending",
				"\t})",
				");",
				"",
				"cursor.rotation.x = - Math.PI / 2;",
				"cursor.position.z = - 5;",
				"",
				"controller.add( cursor );",
				"scene.add( controller );",
				"",
				"renderer.vr.enabled = true;",
				"window.addEventListener( 'resize', resize, false );",
				"resize();",
				"",
				"domElement.appendChild( renderer.domElement );",
				"domElement.appendChild( WEBVR.createButton( renderer ) );",
				"",
				"resources.set( 'renderer', renderer );",
				"resources.set( 'scene', scene );",
				"resources.set( 'camera', camera );",
				"resources.set( 'controller', controller );",
				"",
				"function resize() {",
				"",
				"\tvar rect = domElement.getBoundingClientRect();",
				"\tvar width = rect.width;",
				"\tvar height = rect.height;",
				"\t",
				"\trenderer.setSize( width, height );",
				"\tcamera.aspect = width / height;",
				"\tcamera.updateProjectionMatrix();",
				"",
				"}"
			]
		]
	],
	"effects": [
		[
			"Render",
			[
				"var renderer = resources.get( 'renderer' );",
				"var scene = resources.get( 'scene' );",
				"var camera = resources.get( 'camera' );",
				"var controller = resources.get( 'controller' );",
				"",
				"var direction = new THREE.Vector3( 0, 0, - 1 );",
				"",
				"function start( progress ){}",
				"",
				"function end( progress ){}",
				"",
				"function update( progress ) {",
				"",
				"\tcontroller.update();",
				"\tdirection.set( 0, 0, - 1 );",
				"\tdirection.applyQuaternion( controller.quaternion );",
				"\tcontroller.userData.raycaster.set( controller.position, direction );",
				"\trenderer.render( scene, camera );",
				"",
				"}"
			]
		],
		[
			"Spinning Cube",
			[
				"var scene = resources.get( 'scene' );",
				"var controller = resources.get( 'controller' );",
				"var dragging = false;",
				"var drag = 0.0125;",
				"",
				"var group = new THREE.Group();",
				"",
				"var cube = new THREE.Mesh(",
				"\tnew THREE.BoxBufferGeometry( 5, 5, 5 ),",
				"\tnew THREE.MeshNormalMaterial()",
				");",
				"",
				"cube.rotation.order = 'YXZ';",
				"",
				"var plane = new THREE.Mesh(",
				"\tnew THREE.PlaneBufferGeometry( 50, 50, 10, 10 ),",
				"\tnew THREE.MeshBasicMaterial({",
				"\t\tcolor: 'white',",
				"\t\twireframe: true",
				"\t})",
				");",
				"",
				"plane.userData.delta = new THREE.Vector3();",
				"",
				"group.add( cube );",
				"group.add( plane );",
				"",
				"var rv = new THREE.Euler(",
				"\t0,",
				"\t( Math.random() - 0.5 ) / 15,",
				"\t0",
				");",
				"",
				"rv.ox = rv.x;",
				"rv.oy = rv.y;",
				"rv.oz = rv.z;",
				"",
				"//cube.rotation.x = Math.random() * Math.PI * 2;",
				"//cube.rotation.y = Math.random() * Math.PI * 2;",
				"//cube.rotation.z = Math.random() * Math.PI * 2;",
				"",
				"controller.addEventListener( 'selectstart', function () {",
				"",
				"\tdragging = true;",
				"\tvar intersections = controller.userData.raycaster.intersectObject( plane );",
				"\tif ( intersections.length > 0 ) {",
				"\t\tplane.userData.intersection = intersections[ 0 ].point;",
				"\t}",
				"",
				"} );",
				"",
				"controller.addEventListener( 'selectend', function () {",
				"",
				"\tdragging = false;",
				"\tplane.userData.intersection = null;",
				"",
				"} );",
				"",
				"function start( progress ) {",
				"\tgroup.position.z = - 15;",
				"\tscene.add( group );",
				"}",
				"",
				"function end( progress ) {",
				"\tscene.remove( group );",
				"}",
				"",
				"function update( progress ) {",
				"",
				"\tif ( dragging ) {",
				"",
				"\t\tvar intersections = controller.userData.raycaster.intersectObject( plane );",
				"\t\tif ( intersections.length > 0 ) {",
				"\t\t\tvar intersection = intersections[ 0 ].point;",
				"\t\t\tif ( plane.userData.intersection ) {",
				"\t\t\t\tplane.userData.delta.subVectors( intersection, plane.userData.intersection );",
				"\t\t\t\trv.y = plane.userData.delta.x;",
				"\t\t\t\t//rv.x = - plane.userData.delta.y;",
				"\t\t\t}",
				"\t\t\tplane.userData.intersection = intersection;",
				"\t\t}",
				"",
				"\t} else {",
				"",
				"\t\trv.x += ( rv.ox - rv.x ) * drag;",
				"\t\trv.y += ( rv.oy - rv.y ) * drag;",
				"\t\trv.z += ( rv.oz - rv.z ) * drag;",
				"",
				"\t}",
				"",
				"\tvar rate = Math.abs( rv.y / rv.oy );",
				"\trate = Math.pow( rate, 0.33 );",
				"\tplayer.playbackRate = rate;",
				"",
				"\tcube.rotation.x += rv.x;",
				"\tcube.rotation.y += rv.y;",
				"\tcube.rotation.z += rv.z;",
				"",
				"}"
			]
		],
		[
			"Play Verse",
			[
				"var audio = new WebAudio();",
				"audio.src = '../assets/loops/LOW-beat-up-all-my-cues-for-you.ogg';",
				"",
				"function start( progress ) {",
				"",
				"\tplayer.setAudio( audio );",
				"",
				"}",
				"",
				"function end( progress ) {",
				"",
				"\tplayer.currentTime = 0;",
				"",
				"}",
				"",
				"function update( progress ){}"
			]
		]
	],
	"animations": [
		[
			"Audio",
			0,
			10.6666,
			0,
			2,
			true
		],
		[
			"Scene",
			0,
			10.6666,
			1,
			1,
			true
		],
		[
			"Update Video",
			0,
			10.6666,
			2,
			0,
			true
		]
	]
}
